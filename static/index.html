<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Trading Suite</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" />
  <link rel="stylesheet" href="/static/css/theme.css" />
  <link rel="stylesheet" href="/static/css/listings.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script type="module" src="/static/js/main.js"></script>
</head>
<body>
  <div id="toastContainer" class="toast-container" aria-live="polite"></div>
  <div class="top-bar">
    <div class="title-block">
      <h1>Pair Trading Suite</h1>
      <div class="title-sub">Unified mean-reversion, Bollinger, and trend toolkit</div>
    </div>
    <div class="top-bar-actions">
      <div class="user-badge" id="userBadge" aria-live="polite">Loading user…</div>
      <button class="btn btn-ghost small" id="logoutButton">Logout</button>
      <button class="btn btn-primary" id="openActionCenter">Open action center</button>
      <button class="btn btn-ghost" id="refreshAll">Refresh now</button>
    </div>
  </div>

    <div class="tab-bar">
      <button class="tab active" data-tab="mean">Mean Reversion (Pairs)</button>
      <button class="tab" data-tab="boll">Single-Coin Bollinger</button>
      <button class="tab" data-tab="trend">Trend Following (EMA)</button>
      <button class="tab" data-tab="freqtrade">Freqtrade Adapters</button>
      <button class="tab" data-tab="rs">Relative Strength</button>
      <button class="tab" data-tab="backtest">Backtesting</button>
      <button class="tab" data-tab="trading">Trading Desk</button>
      <button class="tab" data-tab="liquidation">Liquidation Hunt</button>
      <button class="tab" data-tab="listings">Listings Monitor</button>
    </div>

  <div id="tab-mean" class="tab-content active">
    <div class="row">
      <div class="card" data-collapsible>
        <div class="card-header">
          <h2>Live Status</h2>
          <span class="toggle-icon">▼</span>
        </div>
        <div class="card-body">
          <div id="status" class="status-section">Loading...</div>
        </div>
      </div>

      <div class="card" data-collapsible>
        <div class="card-header">
          <h2>Config</h2>
          <span class="toggle-icon">▼</span>
        </div>
        <div class="card-body">
          <div id="mrConfigSummary" class="config-summary">Loading config...</div>
          <div class="help-text">Configure mean reversion settings from the action center.</div>
        </div>
      </div>

      <div class="card" data-collapsible>
        <div class="card-header">
          <h2>Pair Health & History</h2>
          <span class="toggle-icon">▼</span>
        </div>
        <div class="card-body" id="pairHealth">Loading...</div>
      </div>

      <div class="card" data-collapsible>
        <div class="card-header">
          <h2>Manual Trade</h2>
          <span class="toggle-icon">▼</span>
        </div>
        <div class="card-body">
          <form id="manualTradeForm">
            <div class="form-row">
              <div>
                <label for="manual_direction" class="label-with-tip">
                  Direction
                  <span class="tooltip-icon" title="Choose which way to swap the pair immediately, overriding automated signals.">?</span>
                </label>
                <select id="manual_direction">
                  <option value="HBAR->DOGE">HBAR → DOGE</option>
                  <option value="DOGE->HBAR">DOGE → HBAR</option>
                </select>
              </div>
              <div>
                <label for="manual_amount" class="label-with-tip">
                  Amount (<span id="manual_amount_label">HBAR</span>)
                  <span
                    class="tooltip-icon"
                    title="How many units of the FROM asset to swap. Use Max to fill the entire available balance."
                    >?</span
                  >
                </label>
                <div class="input-with-button">
                  <input id="manual_amount" type="number" value="0" step="0.0001" />
                  <button type="button" class="btn btn-ghost small" id="manual_max_btn">Max</button>
                </div>
                <div class="help-text" id="manual_balance_hint"></div>
              </div>
            </div>
            <button type="submit" class="btn btn-primary">Execute manual trade</button>
          </form>
          <div class="help-text">
            Uses market orders on your current environment (testnet / mainnet).
            Start with small amounts to test.
          </div>
        </div>
      </div>
    </div>

    <div class="card" data-collapsible>
      <div class="card-header">
        <h2>Charts</h2>
        <span class="toggle-icon">▼</span>
      </div>
      <div class="card-body">
        <div class="chart-row">
          <div class="chart-col">
            <h3>HBAR / DOGE Prices</h3>
            <canvas id="priceChart" height="160"></canvas>
          </div>
          <div class="chart-col">
            <h3>Ratio & Bands</h3>
            <canvas id="ratioChart" height="160"></canvas>
            <p id="bandInfo"></p>
          </div>
        </div>
      </div>
    </div>

    <div class="card" data-collapsible>
      <div class="card-header">
        <h2>Recent Trades (latest 100)</h2>
        <span class="toggle-icon">▼</span>
      </div>
      <div class="card-body">
        <table id="tradesTable">
          <thead>
            <tr>
              <th>Time</th>
              <th>Side</th>
              <th>From</th>
              <th>To</th>
              <th>Qty from</th>
              <th>Qty to</th>
              <th>Price</th>
              <th>PnL (<span class="quote-label">USDT</span>)</th>
              <th>Env</th>
            </tr>
          </thead>
          <tbody id="tradesBody"></tbody>
        </table>
      </div>
    </div>
  </div>

  <div id="tab-boll" class="tab-content">
    <div class="row">
      <div class="card" data-collapsible>
        <div class="card-header">
          <h2>Bollinger Overview</h2>
          <span class="toggle-icon">▼</span>
        </div>
        <div class="card-body">
          <div id="bollStatus" class="status-section">Loading...</div>
          <div class="inline-metrics" id="bollPosition"></div>
        </div>
      </div>

      <div class="card" data-collapsible>
        <div class="card-header">
          <h2>Account snapshot</h2>
          <span class="toggle-icon">▼</span>
        </div>
        <div class="card-body">
          <div id="bollBalances" class="balance-grid">Loading...</div>
        </div>
      </div>
    </div>

    <div class="card" data-collapsible>
      <div class="card-header">
        <h2>Bollinger Setup</h2>
        <span class="toggle-icon">▼</span>
      </div>
      <div class="card-body">
        <div id="bollConfigSummary" class="config-summary">Loading saved config...</div>
        <div class="help-text">Adjust Bollinger settings from the action center.</div>
      </div>
    </div>

    <div class="card" data-collapsible>
      <div class="card-header">
        <h2>Bollinger Chart</h2>
        <span class="toggle-icon">▼</span>
      </div>
      <div class="card-body">
        <div class="help-text">
          Price vs moving average and Bollinger bands. Use a symbol not overlapping with HBAR/DOGE if both bots are running.
        </div>
        <canvas id="bollChart" height="180"></canvas>
        <p id="bollBandInfo"></p>
      </div>
    </div>

    <div class="card" data-collapsible>
      <div class="card-header">
        <h2>Bollinger Trades (latest 100)</h2>
        <span class="toggle-icon">▼</span>
      </div>
      <div class="card-body">
        <table id="bollTradesTable">
          <thead>
            <tr>
              <th>Time</th>
              <th>Symbol</th>
              <th>Side</th>
              <th>Qty</th>
              <th>Price</th>
              <th>Notional</th>
              <th>PnL (<span class="quote-label">USDT</span>)</th>
              <th>Env</th>
            </tr>
          </thead>
          <tbody id="bollTradesBody"></tbody>
        </table>
      </div>
    </div>

    <div class="card" data-collapsible>
      <div class="card-header">
        <h2>Saved Coin History</h2>
        <span class="toggle-icon">▼</span>
      </div>
      <div class="card-body">
        <div class="help-text">
          Latest saved Bollinger snapshots for the configured symbol. Switch symbols above to view a different coin.
        </div>
        <div class="table-scroll">
          <table id="bollHistoryTable">
            <thead>
              <tr>
                <th>Time</th>
                <th>Price</th>
                <th>MA</th>
                <th>Upper</th>
                <th>Lower</th>
              </tr>
            </thead>
            <tbody id="bollHistoryBody"></tbody>
          </table>
        </div>
        <p id="bollHistoryStatus" class="help-text"></p>
      </div>
    </div>
    </div>

    <div id="tab-trend" class="tab-content">
      <div class="row">
        <div class="card" data-collapsible>
          <div class="card-header">
            <h2>Trend Status</h2>
            <span class="toggle-icon">▼</span>
          </div>
          <div class="card-body" id="trendStatus">Loading...</div>
        </div>

        <div class="card" data-collapsible>
          <div class="card-header">
            <h2>Trend Config</h2>
            <span class="toggle-icon">▼</span>
          </div>
          <div class="card-body">
            <div id="trendConfigSummary" class="config-summary">Loading saved trend config...</div>
            <div class="help-text">Update trend settings from the action center.</div>
          </div>
        </div>
      </div>

      <div class="card" data-collapsible>
        <div class="card-header">
          <h2>Trend Chart</h2>
          <span class="toggle-icon">▼</span>
        </div>
        <div class="card-body">
          <div class="help-text">
            Price versus EMA signals with ATR context. Hover to inspect recent crossovers and stop levels.
          </div>
          <canvas id="trendChart" height="180"></canvas>
          <p id="trendChartInfo"></p>
        </div>
      </div>

      <div class="card" data-collapsible>
        <div class="card-header">
          <h2>Trend History</h2>
          <span class="toggle-icon">▼</span>
        </div>
        <div class="card-body">
          <p id="trendHistoryStatus">Loading...</p>
          <table id="trendHistoryTable">
            <thead>
              <tr>
                <th>Time</th>
                <th>Price</th>
                <th>Fast EMA</th>
                <th>Slow EMA</th>
                <th>ATR</th>
              </tr>
            </thead>
            <tbody id="trendHistoryBody"></tbody>
          </table>
        </div>
      </div>

      <div class="card" data-collapsible>
        <div class="card-header">
          <h2>Trend Trades (latest 100)</h2>
          <span class="toggle-icon">▼</span>
        </div>
        <div class="card-body">
          <p id="trendTradesStatus">Loading...</p>
          <table id="trendTradesTable">
            <thead>
              <tr>
                <th>Time</th>
                <th>Symbol</th>
                <th>Side</th>
                <th>Qty</th>
                <th>Price</th>
                <th>Notional</th>
                <th>PnL (<span class="quote-label">USDT</span>)</th>
                <th>Env</th>
              </tr>
            </thead>
            <tbody id="trendTradesBody"></tbody>
          </table>
        </div>
      </div>
    </div>

    <div id="tab-freqtrade" class="tab-content">
      <div class="row">
        <div class="card" data-collapsible>
          <div class="card-header">
            <h2>Freqtrade Adapters</h2>
            <span class="toggle-icon">▼</span>
          </div>
          <div class="card-body" id="ftStatus">Loading...</div>
        </div>

        <div class="card" data-collapsible>
          <div class="card-header">
            <h2>Strategy Controls</h2>
            <span class="toggle-icon">▼</span>
          </div>
          <div class="card-body">
            <div id="ftConfigSummary" class="config-summary">Choose an algorithm to load its config.</div>
            <div class="button-row">
              <button class="btn" id="openFtConfig">Open freqtrade config</button>
              <button class="btn btn-ghost" id="openActionCenterFreqtrade">Open action center</button>
            </div>
            <div class="help-text">Manage freqtrade algorithms, configuration, and start/stop actions from the action center.</div>
          </div>
        </div>
      </div>

      <div class="card" data-collapsible>
        <div class="card-header">
          <h2>Indicators & History</h2>
          <span class="toggle-icon">▼</span>
        </div>
        <div class="card-body">
          <div class="chart-row">
            <div class="chart-col">
              <h3>Price trail</h3>
              <canvas id="ftChart" width="500" height="180"></canvas>
            </div>
            <div class="chart-col">
              <h3>Recent snapshots</h3>
              <table id="ftHistoryTable">
                <thead>
                  <tr>
                    <th>Time</th>
                    <th>Price</th>
                    <th>Indicator A</th>
                    <th>Indicator B</th>
                    <th>Indicator C</th>
                    <th>Indicator D</th>
                  </tr>
                </thead>
                <tbody id="ftHistoryBody"></tbody>
              </table>
            </div>
          </div>
        </div>
      </div>

      <div class="card" data-collapsible>
        <div class="card-header">
          <h2>Transactions</h2>
          <span class="toggle-icon">▼</span>
        </div>
        <div class="card-body">
          <table id="ftTradesTable">
            <thead>
              <tr>
                <th>Time</th>
                <th>Side</th>
                <th>Price</th>
                <th>Qty</th>
                <th>Notional</th>
                <th>PnL</th>
              </tr>
            </thead>
            <tbody id="ftTradesBody"></tbody>
          </table>
        </div>
      </div>
    </div>

    <div id="tab-rs" class="tab-content">
      <div class="row">
        <div class="card" data-collapsible>
          <div class="card-header">
            <h2>Relative Strength Status</h2>
            <span class="toggle-icon">▼</span>
          </div>
          <div class="card-body" id="rsStatus">Loading...</div>
        </div>

        <div class="card" data-collapsible>
          <div class="card-header">
            <h2>Relative Strength Config</h2>
            <span class="toggle-icon">▼</span>
          </div>
          <div class="card-body">
            <div id="rsConfigSummary" class="config-summary">Loading saved RS config...</div>
            <div class="help-text">Manage RS config from the action center.</div>
          </div>
        </div>
      </div>

      <div class="card" data-collapsible>
        <div class="card-header">
          <h2>Relative Strength Graph</h2>
          <span class="toggle-icon">▼</span>
        </div>
        <div class="card-body">
          <div class="help-text">
            RS score trend for each configured symbol. Use it to spot momentum shifts and divergence between assets.
          </div>
          <canvas id="rsChart" height="180"></canvas>
          <p id="rsChartInfo"></p>
        </div>
      </div>

      <div class="card" data-collapsible>
        <div class="card-header">
          <h2>RS Snapshots</h2>
          <span class="toggle-icon">▼</span>
        </div>
        <div class="card-body">
          <p id="rsHistoryStatus">Loading...</p>
          <table id="rsHistoryTable">
            <thead>
              <tr>
                <th>Time</th>
                <th>Symbol</th>
                <th>Price</th>
                <th>RS</th>
              </tr>
            </thead>
            <tbody id="rsHistoryBody"></tbody>
          </table>
        </div>
      </div>

      <div class="card" data-collapsible>
        <div class="card-header">
          <h2>RS Trades & Rebalances</h2>
          <span class="toggle-icon">▼</span>
        </div>
        <div class="card-body">
          <div class="help-text">Rebalance events are logged whenever a new spread is deployed using available quote balance.</div>
          <p id="rsTradesStatus">Loading...</p>
          <table id="rsTradesTable">
            <thead>
              <tr>
                <th>Time</th>
                <th>Long</th>
                <th>Short</th>
                <th>RS gap</th>
                <th>Notional (USD)</th>
                <th>Env</th>
              </tr>
            </thead>
            <tbody id="rsTradesBody"></tbody>
          </table>
        </div>
      </div>
    </div>

    <div id="tab-backtest" class="tab-content">
      <div class="card" data-collapsible>
        <div class="card-header">
          <h2>Historical backtesting</h2>
          <span class="toggle-icon">▼</span>
        </div>
        <div class="card-body">
          <form id="backtestForm" class="stacked-form">
            <div class="form-row">
              <label>
                Strategy
                <select id="backtestStrategy"></select>
              </label>
              <label id="backtestSymbolRow">
                Symbol
                <input type="text" id="backtestSymbol" value="BTCUSDT" />
              </label>
              <label>
                Interval
                <select id="backtestInterval">
                  <option value="1m">1m</option>
                  <option value="5m">5m</option>
                  <option value="15m">15m</option>
                  <option value="1h">1h</option>
                  <option value="4h">4h</option>
                  <option value="1d">1d</option>
                </select>
              </label>
              <label>
                Lookback (days)
                <input type="number" id="backtestLookback" min="1" step="1" value="30" />
              </label>
            </div>

            <div class="form-row">
              <label>
                Start date
                <input type="date" id="backtestStartDate" />
              </label>
              <label>
                End date
                <input type="date" id="backtestEndDate" />
              </label>
            </div>

            <div class="form-row" id="backtestPairFields">
              <label>
                Asset A
                <input type="text" id="backtestAssetA" value="HBAR" />
              </label>
              <label>
                Asset B
                <input type="text" id="backtestAssetB" value="DOGE" />
              </label>
            </div>

            <div class="form-row" id="backtestBollFields">
              <label>
                Window size
                <input type="number" id="backtestWindow" min="5" step="5" value="70" />
              </label>
              <label>
                Std dev width
                <input type="number" id="backtestStd" step="0.1" value="3" />
              </label>
            </div>

            <div class="form-row" id="backtestTrendFields">
              <label>
                Fast EMA
                <input type="number" id="backtestFast" min="2" step="1" value="12" />
              </label>
              <label>
                Slow EMA
                <input type="number" id="backtestSlow" min="5" step="1" value="26" />
              </label>
              <label>
                ATR window
                <input type="number" id="backtestAtrWindow" min="3" step="1" value="14" />
              </label>
              <label>
                ATR stop (x)
                <input type="number" id="backtestAtrStop" min="0.1" step="0.1" value="2.0" />
              </label>
            </div>

            <div class="form-row" id="backtestMrFields">
              <label>
                Z-entry
                <input type="number" id="backtestZEntry" step="0.1" value="3.0" />
              </label>
              <label>
                Z-exit
                <input type="number" id="backtestZExit" step="0.1" value="0.4" />
              </label>
            </div>

            <div class="form-row" id="backtestCommonFields">
              <label>
                Starting balance (USD)
                <input type="number" id="backtestStartingBalance" step="100" value="1000" />
              </label>
            </div>

            <div class="button-row">
              <button type="submit" class="btn btn-primary">Run backtest</button>
              <div class="help-text">Use optional start/end dates to replay a specific month (e.g. last August) instead of the rolling lookback. Uses live Binance historical klines to replay each algorithm without placing orders.</div>
            </div>
          </form>

          <div class="card" style="margin-top: 18px;">
            <div class="card-header">
              <h3>Summary</h3>
            </div>
            <div class="card-body" id="backtestSummary">Run a backtest to see performance.</div>
          </div>

          <div class="card" style="margin-top: 18px;">
            <div class="card-header">
              <h3>Trades</h3>
            </div>
            <div class="card-body table-wrapper">
              <table id="backtestTrades">
                <thead>
                  <tr>
                    <th>Time</th>
                    <th>Action</th>
                    <th>Size</th>
                    <th>Price</th>
                    <th>PnL</th>
                  </tr>
                </thead>
                <tbody></tbody>
              </table>
            </div>
          </div>

          <div class="card" style="margin-top: 18px;">
            <div class="card-header">
              <h3>Equity trail (last 50 points)</h3>
            </div>
            <div class="card-body table-wrapper">
              <table id="backtestEquity">
                <thead>
                  <tr>
                    <th>Time</th>
                    <th>Equity</th>
                  </tr>
                </thead>
                <tbody></tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="tab-trading" class="tab-content">
    <div class="row">
      <div class="card" data-collapsible>
        <div class="card-header">
          <h2>Accounts</h2>
          <span class="toggle-icon">▼</span>
        </div>
        <div class="card-body">
          <div class="form-row">
            <div>
              <label for="tradingEnv" class="label-with-tip">
                Environment
                <span class="tooltip-icon" title="Choose whether manual desk actions use mainnet or testnet endpoints.">?</span>
              </label>
              <select id="tradingEnv">
                <option value="testnet">Testnet</option>
                <option value="mainnet">Mainnet</option>
              </select>
            </div>
            <div>
              <label for="tradingAccount" class="label-with-tip">
                Account keys
                <span class="tooltip-icon" title="Pick which configured API key set to use for account queries and orders.">?</span>
              </label>
              <select id="tradingAccount">
                <option value="mr">Mean Reversion keys</option>
                <option value="boll">Bollinger keys</option>
              </select>
            </div>
          </div>
          <div id="tradingBalances" class="balance-grid">Loading...</div>
        </div>
      </div>

      <div class="card" data-collapsible>
        <div class="card-header">
          <h2>Manual order</h2>
          <span class="toggle-icon">▼</span>
        </div>
        <div class="card-body">
          <form id="tradingOrderForm">
            <div class="form-row">
              <div>
                <label for="tradingSymbol" class="label-with-tip">
                  Symbol
                  <span class="tooltip-icon" title="Market symbol to trade from the selected account and environment.">?</span>
                </label>
                <input id="tradingSymbol" list="tradingSymbolList" placeholder="e.g. BTCUSDT" />
                <datalist id="tradingSymbolList"></datalist>
              </div>
              <div>
                <label for="tradingSide" class="label-with-tip">
                  Side
                  <span class="tooltip-icon" title="Choose BUY to acquire the base asset or SELL to offload it.">?</span>
                </label>
                <select id="tradingSide">
                  <option value="BUY">Buy</option>
                  <option value="SELL">Sell</option>
                </select>
              </div>
              <div>
                <label for="tradingQty" class="label-with-tip">
                  Qty (base)
                  <span class="tooltip-icon" title="Base-asset quantity to send with the manual order.">?</span>
                </label>
                <input id="tradingQty" type="number" min="0" step="0.0001" />
              </div>
            </div>
            <button type="submit" class="btn btn-primary">Execute</button>
          </form>
          <div class="help-text">Uses whichever API key set you pick above. Balances refresh automatically after the trade.</div>
        </div>
      </div>
    </div>
  </div>

  <div id="tab-liquidation" class="tab-content">
    <div class="row">
      <div class="card" style="flex: 2;">
        <div class="card-header">
          <h2>Live Signal</h2>
          <span class="chip" id="liqSignalChip">Waiting...</span>
        </div>
        <div class="card-body">
          <div class="status-section status-highlight" id="liqActionableSummary">No scan data yet.</div>
          <div class="status-section" id="liqSignalSummary">-</div>
          <div class="metric-grid" style="margin-top: 16px;">
            <div class="metric-group">
              <div class="metric-label">Symbol</div>
              <div class="metric-value" id="liqSymbolLabel">-</div>
            </div>
            <div class="metric-group">
              <div class="metric-label">Sweep level</div>
              <div class="metric-value" id="liqSweepLevel">-</div>
            </div>
            <div class="metric-group">
              <div class="metric-label">Confidence</div>
              <div class="metric-value" id="liqConfidenceLabel">-</div>
            </div>
            <div class="metric-group">
              <div class="metric-label">Entry</div>
              <div class="metric-value" id="liqEntryLabel">-</div>
            </div>
            <div class="metric-group">
              <div class="metric-label">Stop</div>
              <div class="metric-value" id="liqStopLabel">-</div>
            </div>
            <div class="metric-group">
              <div class="metric-label">Target</div>
              <div class="metric-value" id="liqTargetLabel">-</div>
            </div>
          </div>
          <div class="metric-grid compact" style="margin-top: 10px;">
            <div class="metric-group">
              <div class="metric-label">Stop distance</div>
              <div class="metric-value" id="liqStopDistance">-</div>
              <div class="metric-sub">Move from entry to stop</div>
            </div>
            <div class="metric-group">
              <div class="metric-label">Target distance</div>
              <div class="metric-value" id="liqTargetDistance">-</div>
              <div class="metric-sub">Move from entry to take-profit</div>
            </div>
            <div class="metric-group">
              <div class="metric-label">Live RR</div>
              <div class="metric-value" id="liqLiveRR">-</div>
              <div class="metric-sub">Computed from the current levels</div>
            </div>
          </div>
          <div class="pill-row" id="liqPoolSplit"></div>
          <div class="status-line" id="liqNextStep">Waiting for first scan...</div>
        </div>
      </div>

      <div class="card" style="flex: 1;">
        <div class="card-header">
          <h2>Scanner Config</h2>
        </div>
        <div class="card-body">
          <div class="config-summary" id="liqConfigSummary">Configure liquidation scanning from the action center.</div>
          <div class="pill-row" id="liqEnvRow">
            <span class="chip chip-primary" id="liqEnvChip">Environment: -</span>
            <span class="chip" id="liqAutoChip">Auto-trading: -</span>
            <span class="chip chip-muted" id="liqCadenceChip">Polling cadence: -</span>
          </div>
          <div class="button-row">
            <button class="btn btn-primary" id="liqInlineRescan">Manual rescan</button>
            <button class="btn btn-ghost" id="liqInlineExecute">Execute signal</button>
            <button class="btn" id="openLiqConfigInlineSecondary">Edit config</button>
            <button class="btn btn-ghost" id="liqAutoToggleBtn">Toggle auto-trading</button>
          </div>
          <ul class="hint-list">
            <li>The scanner hunts for long/short liquidity pools and alerts when a wick sweeps them.</li>
            <li>Use Manual rescan after saving config to force fresh candles and clusters.</li>
            <li>Auto-trading keeps size from the config. Execute signal runs with current settings.</li>
          </ul>
        </div>
      </div>
    </div>

    <div class="card" data-collapsible>
      <div class="card-header">
        <h2>How this scanner works</h2>
        <span class="toggle-icon">▼</span>
      </div>
      <div class="card-body">
        <div class="status-section">
          <div class="status-line">1) Build liquidity clusters from swing highs/lows where stops collect.</div>
          <div class="status-line">2) Wait for a wick that sweeps those stops then closes back inside.</div>
          <div class="status-line">3) Emit an entry, stop, and target with a confidence score plus heatmap.</div>
        </div>
        <div class="status-highlight" id="liqPlaybook">No signal detected yet. Once a sweep prints, you will see a narrated setup here.</div>
      </div>
    </div>

    <div class="card">
      <div class="card-header">
        <h2>Liquidity Heatmap</h2>
        <span class="chip chip-primary" id="liqClusterCount">0 pools</span>
      </div>
      <div class="card-body">
        <canvas id="liqHeatmapChart" height="180"></canvas>
        <div class="help-text" style="margin-top: 8px;">
          Blue = long-liquidity pools (below price), Red = short-liquidity pools (above price). Bars are scaled by how many swing touches built up there.
        </div>
      </div>
    </div>

    <div class="card">
      <div class="card-header">
        <h2>Latest 60 candles (1m)</h2>
        <span class="chip" id="liqLastExecution">No trades yet</span>
      </div>
      <div class="card-body">
        <table class="table" id="liqCandleTable">
          <thead>
            <tr><th>Time</th><th>Open</th><th>High</th><th>Low</th><th>Close</th></tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
  </div>

  <div id="tab-listings" class="tab-content">
    <div class="card">
      <div class="card-header">
        <h2>Binance listing scout</h2>
        <span class="chip" id="scoutStatus">Scout stopped</span>
      </div>
      <div class="card-body">
        <div class="muted">Use Configure scout to view and edit listing settings.</div>
        <div class="help-text">
          Listing scout controls and configuration live in the action center. Use the action center to start, stop, or buy
          symbols, and adjust the per-listing buy size and exit trigger.
        </div>
        <div id="scoutPositions" class="health-grid"></div>
      </div>
    </div>

    <div class="row">
      <div class="card" data-collapsible>
        <div class="card-header">
          <h2>Filters</h2>
          <span class="toggle-icon">▼</span>
        </div>
        <div class="card-body">
          <div class="filters-grid">
            <label class="stacked-field">
              Exchange type
              <select id="exchangeType">
                <option value="">All</option>
                <option value="cex">CEX</option>
                <option value="dex">DEX</option>
              </select>
            </label>
            <label class="stacked-field">
              Exchange
              <input id="exchange" type="text" placeholder="Binance, OKX..." />
            </label>
            <label class="stacked-field">
              Network
              <input id="network" type="text" placeholder="ETH, BSC, Base" />
            </label>
            <label class="stacked-field">
              Time window (mins)
              <input id="minutes" type="number" value="120" min="5" max="1440" />
            </label>
            <label class="stacked-field">
              Search
              <input id="search" type="text" placeholder="Symbol or name" />
            </label>
            <label class="stacked-field">
              Sort
              <select id="sort">
                <option value="listed_at_desc">Newest</option>
                <option value="listed_at_asc">Oldest</option>
              </select>
            </label>
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="card">
        <div class="card-header">
          <h2>Collector health</h2>
        </div>
        <div class="card-body">
          <div id="healthStatus" class="health-grid"></div>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="card-header">
        <h2>Recent listings</h2>
      </div>
      <div class="card-body">
        <div class="table-wrapper">
          <table id="listingsTable">
            <thead>
              <tr>
                <th>Symbol</th>
                <th>Name</th>
                <th>Pair</th>
              <th>Network</th>
              <th>Source</th>
              <th>Listed at</th>
              <th>Link</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
      </div>
    </div>
  </div>

  <div id="actionModalOverlay" class="modal-overlay">
    <div class="modal wide">
      <div class="modal-header">
        <div class="modal-header-title">Action center</div>
        <button class="btn btn-ghost small" data-close-overlay="actionModalOverlay">✕</button>
      </div>
      <div class="modal-body action-grid">
        <div class="action-column">
          <div class="modal-subtitle">Mean reversion</div>
          <div class="button-stack">
            <button class="btn btn-primary" id="startBotBtn">Start MR bot</button>
            <button class="btn btn-danger" id="stopBotBtn">Stop MR bot</button>
            <button class="btn btn-ghost" id="syncStateBtn">Sync MR balances</button>
            <button class="btn btn-ghost" id="nextTradeBtn">Next MR trade</button>
            <button class="btn" id="openMrConfigInline">Configure MR</button>
          </div>
        </div>
        <div class="action-column">
          <div class="modal-subtitle">Bollinger</div>
          <div class="button-stack">
            <button class="btn btn-primary" id="startBollBtn">Start Bollinger bot</button>
            <button class="btn btn-danger" id="stopBollBtn">Stop Bollinger bot</button>
            <button class="btn" id="openBollConfigInline">Configure Bollinger</button>
          </div>
        </div>
        <div class="action-column">
          <div class="modal-subtitle">Trend following</div>
          <div class="button-stack">
            <button class="btn btn-primary" id="startTrendBtn">Start Trend bot</button>
            <button class="btn btn-danger" id="stopTrendBtn">Stop Trend bot</button>
            <button class="btn" id="openTrendConfigInline">Configure Trend</button>
          </div>
        </div>
        <div class="action-column">
          <div class="modal-subtitle">Freqtrade adapters</div>
          <div class="button-stack">
            <button class="btn btn-primary" id="ftStartBtn">Start adapter</button>
            <button class="btn btn-danger" id="ftStopBtn">Stop adapter</button>
            <button class="btn" id="openFtConfigInline">Configure freqtrade</button>
            <button class="btn btn-ghost" id="openFtHelp">Docs</button>
          </div>
        </div>
        <div class="action-column">
          <div class="modal-subtitle">Relative strength</div>
          <div class="button-stack">
            <button class="btn btn-primary" id="startRSBtn">Start RS bot</button>
            <button class="btn btn-danger" id="stopRSBtn">Stop RS bot</button>
            <button class="btn" id="openRSConfigInline">Configure RS</button>
          </div>
        </div>
        <div class="action-column">
          <div class="modal-subtitle">Liquidation hunt</div>
          <div class="button-stack">
            <button class="btn btn-primary" id="liqEnableBtn">Start Scanner bot</button>
            <button class="btn btn-danger" id="liqDisableBtn">Stop Scanner ot</button>
            <button class="btn btn-ghost" id="liqRescanBtn">Manual rescan</button>
            <button class="btn btn-ghost" id="liqExecuteBtn">Execute current signal</button>
            <button class="btn" id="openLiqConfigInline">Configure scanner</button>
          </div>
        </div>
        <div class="action-column">
          <div class="modal-subtitle">Binance listings</div>
          <div class="button-stack">
            <button class="btn btn-primary" id="startScoutInline">Start scout</button>
            <button class="btn btn-danger" id="stopScoutInline">Stop scout</button>
            <button class="btn btn-ghost" id="refreshScoutInline">Refresh status</button>
            <button class="btn" id="actionListingBuyBtn">Buy symbol now</button>
            <button class="btn" id="openListingConfigInline">Configure scout</button>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-ghost" data-close-overlay="actionModalOverlay">Close</button>
      </div>
    </div>
  </div>

  <div id="liqConfigOverlay" class="modal-overlay">
    <div class="modal">
      <div class="modal-header">
        <div class="modal-header-title">Liquidation scanner config</div>
        <button class="btn btn-ghost small" data-close-overlay="liqConfigOverlay">✕</button>
      </div>
      <div class="modal-body">
        <form id="liqConfigForm" class="stacked-form">
          <label>
            Symbol
            <input type="text" id="liqCfgSymbol" value="BTCUSDT" />
          </label>
          <label>
            Lookback candles
            <input type="number" id="liqCfgLookback" min="30" step="10" value="200" />
          </label>
          <label>
            Cluster tolerance (bps)
            <input type="number" id="liqCfgTolerance" min="1" step="1" value="12" />
          </label>
          <label>
            Wick/body ratio
            <input type="number" id="liqCfgWickRatio" min="1" step="0.1" value="2.2" />
          </label>
          <label>
            Risk:Reward multiple
            <input type="number" id="liqCfgRR" min="1" step="0.1" value="2.5" />
          </label>
          <label>
            Poll interval (sec)
            <input type="number" id="liqCfgPoll" min="5" step="1" value="30" />
          </label>
          <label>
            Auto-trade notional (USD)
            <input type="number" id="liqCfgNotional" min="1" step="1" value="50" />
          </label>
          <label class="form-checkbox">
            <input type="checkbox" id="liqCfgAuto" />
            <span>Enable auto-trading on sweeps</span>
          </label>
          <label class="form-checkbox">
            <input type="checkbox" id="liqCfgTestnet" checked />
            <span>Use Binance testnet</span>
          </label>
          <div class="button-row">
            <button type="submit" class="btn btn-primary">Save config</button>
            <button type="button" class="btn btn-ghost" data-close-overlay="liqConfigOverlay">Cancel</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <div id="listingConfigOverlay" class="modal-overlay">
    <div class="modal">
      <div class="modal-header">
        <div class="modal-header-title">Listing scout config</div>
        <button class="btn btn-ghost small" data-close-overlay="listingConfigOverlay">✕</button>
      </div>
      <div class="modal-body">
        <form id="listingConfigForm">
          <div class="form-row">
            <div>
              <label for="listingConfigNotional" class="label-with-tip">
                Buy size per listing (EUR)
                <span class="tooltip-icon" title="Approximate euro amount allocated to each new Binance listing when the scout triggers.">?</span>
              </label>
              <input id="listingConfigNotional" type="number" min="1" step="1" value="10" required />
            </div>
            <div>
              <label for="listingConfigExit" class="label-with-tip">
                Exit trigger (% gain)
                <span class="tooltip-icon" title="Percentage gain over entry where the scout will try to sell the position.">?</span>
              </label>
              <input id="listingConfigExit" type="number" min="1" step="0.1" value="8" required />
            </div>
          </div>
          <div class="button-row">
            <button type="submit" class="btn btn-primary">Save config</button>
            <button type="button" class="btn btn-ghost" data-close-overlay="listingConfigOverlay">Cancel</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <div id="mrConfigOverlay" class="modal-overlay">
    <div class="modal wide">
      <div class="modal-header">
        <div class="modal-header-title">Mean reversion config</div>
        <button class="btn btn-ghost small" data-close-overlay="mrConfigOverlay">✕</button>
      </div>
      <div class="modal-body">
        <form id="configForm">
          <div class="form-row">
            <div>
              <label for="pair_select" class="label-with-tip">
                Trading pair
                <span class="tooltip-icon" title="Select the correlated asset pair used for mean reversion calculations and trades.">?</span>
              </label>
              <select id="pair_select"></select>
            </div>
            <div>
              <label for="poll_interval_sec" class="label-with-tip">
                Poll interval (sec)
                <span class="tooltip-icon" title="Seconds between price polls, ratio updates, and trading checks.">?</span>
              </label>
              <input id="poll_interval_sec" type="number" min="5" step="1" />
            </div>
            <div>
              <label for="window_size" class="label-with-tip">
                Window size
                <span class="tooltip-icon" title="Number of recent samples used to compute the mean and standard deviation for the ratio.">?</span>
              </label>
              <input id="window_size" type="number" min="5" step="1" />
            </div>
            <div>
              <label for="z_entry" class="label-with-tip">
                z-entry
                <span class="tooltip-icon" title="Z-score threshold that must be crossed before opening a mean-reversion trade.">?</span>
              </label>
              <input id="z_entry" type="number" step="0.1" />
            </div>
            <div>
              <label for="z_exit" class="label-with-tip">
                z-exit
                <span class="tooltip-icon" title="Z-score threshold that signals when to close an open position back toward the mean.">?</span>
              </label>
              <input id="z_exit" type="number" step="0.1" />
            </div>
            <div>
              <label for="trade_notional_usd" class="label-with-tip">
                Trade notional (<span class="quote-label">USDT</span>)
                <span class="tooltip-icon" title="Target USD value for each leg of the trade when not using full balances.">?</span>
              </label>
              <input id="trade_notional_usd" type="number" step="1" />
            </div>
          </div>

          <div class="form-row">
            <div class="form-checkbox">
              <input type="checkbox" id="use_all_balance" />
              <label for="use_all_balance" class="label-with-tip">
                Use all available HBAR/DOGE
                <span class="tooltip-icon" title="Trade using the entire available balances instead of the fixed notional size.">?</span>
              </label>
            </div>
            <div class="form-checkbox">
              <input type="checkbox" id="use_ratio_thresholds" />
              <label for="use_ratio_thresholds" class="label-with-tip">
                Use fixed ratio thresholds
                <span class="tooltip-icon" title="Apply static buy/sell ratio bands instead of z-score based entries and exits.">?</span>
              </label>
            </div>
            <div>
              <label for="sell_ratio_threshold" class="label-with-tip">
                Sell ratio threshold
                <span class="tooltip-icon" title="If the ratio rises above this level, the bot sells the first asset and buys the second.">?</span>
              </label>
              <input id="sell_ratio_threshold" type="number" step="0.0001" />
            </div>
            <div>
              <label for="buy_ratio_threshold" class="label-with-tip">
                Buy ratio threshold
                <span class="tooltip-icon" title="If the ratio falls below this level, the bot buys the first asset and sells the second.">?</span>
              </label>
              <input id="buy_ratio_threshold" type="number" step="0.0001" />
            </div>
            <div class="form-checkbox">
              <input type="checkbox" id="use_testnet" />
              <label for="use_testnet" class="label-with-tip">
                Use Binance testnet
                <span class="tooltip-icon" title="Route all mean-reversion trades to the Binance testnet instead of live trading.">?</span>
              </label>
            </div>
          </div>

          <div class="button-row">
            <button type="submit" class="btn btn-primary">Save config</button>
            <button type="button" class="btn btn-ghost" id="generateConfigBtn">Generate from history</button>
            <button type="button" class="btn" data-close-overlay="mrConfigOverlay">Close</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <div id="ftConfigOverlay" class="modal-overlay">
    <div class="modal wide">
      <div class="modal-header">
        <div class="modal-header-title">Freqtrade adapters</div>
        <button class="btn btn-ghost small" data-close-overlay="ftConfigOverlay">✕</button>
      </div>
      <div class="modal-body">
        <div class="stacked-form">
          <label for="ftStrategySelect">Algorithm</label>
          <select id="ftStrategySelect">
            <option value="">Select…</option>
            <option value="pattern_recognition">PatternRecognition (1D)</option>
            <option value="strategy001">Strategy001 (EMA + HA)</option>
            <option value="strategy002">Strategy002 (RSI/Stoch)</option>
            <option value="strategy003">Strategy003 (MFI/Boll/EMA)</option>
            <option value="supertrend">Supertrend (1H)</option>
          </select>
        </div>
        <form id="ftConfigForm" class="stacked">
          <div class="form-row">
            <div class="form-field">
              <label for="ft_symbol" class="label-with-tip">Symbol<span class="tooltip-icon" title="Market symbol to trade (e.g., BTCUSDT).">?</span></label>
              <input id="ft_symbol" name="symbol" type="text" placeholder="BTCUSDT" />
            </div>
            <div class="form-field">
              <label for="ft_timeframe" class="label-with-tip">Timeframe<span class="tooltip-icon" title="Binance interval like 1d or 5m.">?</span></label>
              <input id="ft_timeframe" name="timeframe" type="text" placeholder="1d" />
            </div>
          </div>
          <div class="form-row">
            <div class="form-field">
              <label for="ft_poll" class="label-with-tip">Poll interval (sec)<span class="tooltip-icon" title="Seconds between indicator refresh.">?</span></label>
              <input id="ft_poll" name="poll_interval_sec" type="number" min="5" step="1" />
            </div>
            <div class="form-field">
              <label for="ft_max_position" class="label-with-tip">Max position (USD)<span class="tooltip-icon" title="Virtual notional for simulated fills.">?</span></label>
              <input id="ft_max_position" name="max_position_usd" type="number" step="1" />
            </div>
          </div>
          <div class="form-row">
            <div class="form-field">
              <label for="ft_buy_threshold" class="label-with-tip">Pattern threshold<span class="tooltip-icon" title="CDL High-Wave trigger (default -100)">?</span></label>
              <input id="ft_buy_threshold" name="buy_threshold" type="number" step="1" />
            </div>
            <div class="form-field checkbox-field">
              <input type="checkbox" id="ft_use_testnet" name="use_testnet" />
              <label for="ft_use_testnet">Use testnet</label>
            </div>
          </div>
          <div class="button-row">
            <button type="submit" class="btn btn-primary">Save config</button>
            <button type="button" class="btn btn-ghost" data-close-overlay="ftConfigOverlay">Close</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <div id="bollConfigOverlay" class="modal-overlay">
    <div class="modal wide">
      <div class="modal-header">
        <div class="modal-header-title">Bollinger config</div>
        <button class="btn btn-ghost small" data-close-overlay="bollConfigOverlay">✕</button>
      </div>
      <div class="modal-body">
        <form id="bollConfigForm" class="bollinger-form">
          <div class="bollinger-grid">
            <div class="config-panel">
              <div class="panel-heading">
                <div>
                  <div class="panel-title">Symbol &amp; routing</div>
                  <div class="panel-subtitle">Pick a liquid market and where orders are sent.</div>
                </div>
                <span class="chip chip-muted">Setup</span>
              </div>
              <div class="form-stack">
                <div class="symbol-picker">
                  <div class="symbol-select-row">
                    <div class="symbol-select">
                      <label for="boll_symbol" class="label-with-tip">
                        Symbol
                        <span class="tooltip-icon" title="Trading symbol for the Bollinger bot. Choose a pair with healthy liquidity.">?</span>
                      </label>
                      <select id="boll_symbol"></select>
                    </div>
                    <div>
                      <label for="bollQuoteFilter" class="label-with-tip">
                        Quote filter
                        <span class="tooltip-icon" title="Limit the available symbols by quote asset to quickly narrow the dropdown list.">?</span>
                      </label>
                      <select id="bollQuoteFilter">
                        <option value="all">All quotes</option>
                        <option value="USDT">USDT</option>
                        <option value="USDC">USDC</option>
                        <option value="BTC">BTC</option>
                        <option value="BNB">BNB</option>
                      </select>
                    </div>
                  </div>
                  <div class="pill-row" id="bollSymbolPills"></div>
                </div>
                <div class="form-row slim">
                  <div>
                    <label for="boll_trade_notional" class="label-with-tip">
                      Max position (<span class="quote-label">USDT</span>)
                      <span class="tooltip-icon" title="Quote allocation cap per trade when not using full balances.">?</span>
                    </label>
                    <input id="boll_trade_notional" type="number" step="1" />
                  </div>
                  <div>
                    <label for="boll_window" class="label-with-tip">
                      MA window
                      <span class="tooltip-icon" title="Window for the moving average underpinning the bands.">?</span>
                    </label>
                    <input id="boll_window" type="number" step="1" min="5" />
                  </div>
                  <div>
                    <label for="boll_dev" class="label-with-tip">
                      Deviation multiplier (k)
                      <span class="tooltip-icon" title="Standard deviation multiplier controlling how wide the bands are.">?</span>
                    </label>
                    <input id="boll_dev" type="number" step="0.1" min="0.5" />
                  </div>
                </div>
                <div class="form-row slim">
                  <div>
                    <label for="boll_stop_loss" class="label-with-tip">
                      Stop loss (%)
                      <span class="tooltip-icon" title="Fractional stop below entry before flattening the position (e.g. 0.1 = 10%).">?</span>
                    </label>
                    <input id="boll_stop_loss" type="number" step="0.01" min="0" />
                  </div>
                  <div>
                    <label for="boll_take_profit" class="label-with-tip">
                      Take profit (%)
                      <span class="tooltip-icon" title="Fractional take-profit above entry (e.g. 0.2 = 20%).">?</span>
                    </label>
                    <input id="boll_take_profit" type="number" step="0.01" min="0" />
                  </div>
                  <div>
                    <label for="boll_cooldown" class="label-with-tip">
                      Cooldown (sec)
                      <span class="tooltip-icon" title="Minimum time between entries to avoid churn while hugging the bands.">?</span>
                    </label>
                    <input id="boll_cooldown" type="number" step="1" min="0" />
                  </div>
                </div>
                <div class="form-row slim">
                  <div class="form-checkbox">
                    <input type="checkbox" id="boll_use_all_balance" />
                    <label for="boll_use_all_balance" class="label-with-tip">
                      Use full quote balance
                      <span class="tooltip-icon" title="Allocate the full quote balance instead of the capped notional.">?</span>
                    </label>
                  </div>
                  <div class="form-checkbox">
                    <input type="checkbox" id="boll_use_testnet" />
                    <label for="boll_use_testnet" class="label-with-tip">
                      Use Binance testnet
                      <span class="tooltip-icon" title="Route Bollinger orders to testnet.">?</span>
                    </label>
                  </div>
                </div>
              </div>
              <div class="panel-note">Stops and targets are calculated off the entry fill; set both when experimenting on live markets.</div>
            </div>

            <div class="config-panel info-panel">
              <div class="panel-heading">
                <div>
                  <div class="panel-title">Operating notes</div>
                  <div class="panel-subtitle">Quick reminders before you hit save.</div>
                </div>
                <span class="chip chip-primary">Tips</span>
              </div>
              <ul class="muted-list">
                <li>Use the quote filter to keep the dropdown manageable; curated chips highlight pairs with healthy liquidity.</li>
                <li>Cooldowns prevent churn when price hugs the bands; increase the value if you see repeated flips.</li>
                <li>Testnet routes orders to sandbox keys only—ideal for dry runs before enabling mainnet access.</li>
                <li>Adjust the deviation multiplier to control how aggressive entries are. Smaller numbers fire more often.</li>
              </ul>
              <div class="panel-note subtle">Need a starting point? Generate a config from historical saves, then review the summary chips above.</div>
            </div>
          </div>
          <div class="button-row">
            <button type="button" class="btn" id="bollGenerateConfigBtn">Generate from history</button>
            <button type="submit" class="btn btn-primary">Save Bollinger config</button>
            <button type="button" class="btn" data-close-overlay="bollConfigOverlay">Close</button>
          </div>
          <div class="help-text">Curated chips keep you away from scrolling through hundreds of pairs. Use the quote filter to narrow the list.</div>
        </form>
      </div>
    </div>
  </div>

  <div id="trendConfigOverlay" class="modal-overlay">
    <div class="modal wide">
      <div class="modal-header">
        <div class="modal-header-title">Trend config</div>
        <button class="btn btn-ghost small" data-close-overlay="trendConfigOverlay">✕</button>
      </div>
      <div class="modal-body">
        <form id="trendConfigForm">
          <div class="form-row">
            <div>
              <label for="trend_symbol" class="label-with-tip">
                Trading symbol
                <span class="tooltip-icon" title="Coin pair for the EMA/ATR crossover entries. Choose a liquid symbol like BTCUSDT or ETHUSDT.">?</span>
              </label>
              <input id="trend_symbol" name="symbol" type="text" placeholder="BTCUSDT" />
            </div>
            <div>
              <label for="trend_poll_interval" class="label-with-tip">
                Poll interval (sec)
                <span class="tooltip-icon" title="Seconds between price polls, EMA updates, and trading checks.">?</span>
              </label>
              <input id="trend_poll_interval" name="poll_interval_sec" type="number" min="5" step="1" />
            </div>
            <div>
              <label for="trend_fast_window" class="label-with-tip">
                Fast EMA window
                <span class="tooltip-icon" title="Samples used for the fast EMA. Lower values react faster to price swings.">?</span>
              </label>
              <input id="trend_fast_window" name="fast_window" type="number" min="2" step="1" />
            </div>
            <div>
              <label for="trend_slow_window" class="label-with-tip">
                Slow EMA window
                <span class="tooltip-icon" title="Samples used for the slow EMA baseline. Larger windows smooth out noise.">?</span>
              </label>
              <input id="trend_slow_window" name="slow_window" type="number" min="3" step="1" />
            </div>
          </div>

          <div class="form-row">
            <div>
              <label for="trend_atr_window" class="label-with-tip">
                ATR window
                <span class="tooltip-icon" title="Period used to compute ATR for volatility-aware stops and sizing.">?</span>
              </label>
              <input id="trend_atr_window" name="atr_window" type="number" min="1" step="1" />
            </div>
            <div>
              <label for="trend_atr_stop" class="label-with-tip">
                ATR stop multiplier
                <span class="tooltip-icon" title="Multiple of ATR used for trailing risk control below the entry price.">?</span>
              </label>
              <input id="trend_atr_stop" name="atr_stop_mult" type="number" step="0.1" />
            </div>
            <div>
              <label for="trend_max_position" class="label-with-tip">
                Max position (<span class="quote-label">USDT</span>)
                <span class="tooltip-icon" title="Maximum quote allocation per position. Use lower amounts while testing.">?</span>
              </label>
              <input id="trend_max_position" name="max_position_usd" type="number" step="1" />
            </div>
            <div>
              <label for="trend_cooldown" class="label-with-tip">
                Cooldown (sec)
                <span class="tooltip-icon" title="Minimum wait between consecutive entries to avoid over-trading.">?</span>
              </label>
              <input id="trend_cooldown" name="cooldown_sec" type="number" min="0" step="1" />
            </div>
          </div>

          <div class="form-row">
            <div class="form-checkbox">
              <input type="checkbox" id="trend_use_all" name="use_all_balance" />
              <label for="trend_use_all" class="label-with-tip">
                Use all quote balance
                <span class="tooltip-icon" title="If enabled, allocate the full available quote balance instead of the max position cap.">?</span>
              </label>
            </div>
            <div class="form-checkbox">
              <input type="checkbox" id="trend_use_testnet" name="use_testnet" />
              <label for="trend_use_testnet" class="label-with-tip">
                Use Binance testnet
                <span class="tooltip-icon" title="Send trend-following orders to Binance testnet instead of mainnet.">?</span>
              </label>
            </div>
          </div>

          <div class="button-row">
            <button type="submit" class="btn btn-primary">Save config</button>
            <button type="button" class="btn" data-close-overlay="trendConfigOverlay">Close</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <div id="rsConfigOverlay" class="modal-overlay">
    <div class="modal wide">
      <div class="modal-header">
        <div class="modal-header-title">Relative strength config</div>
        <button class="btn btn-ghost small" data-close-overlay="rsConfigOverlay">✕</button>
      </div>
      <div class="modal-body">
        <form id="rsConfigForm">
          <div class="form-row">
            <div>
              <label for="rs_symbols" class="label-with-tip">
                Symbols (comma separated)
                <span class="tooltip-icon" title="Universe of quote symbols to rank using relative strength (e.g. BTCUSDC, ETHUSDC).">?</span>
              </label>
              <input id="rs_symbols" name="symbols" type="text" placeholder="BTCUSDC,ETHUSDC" />
            </div>
            <div>
              <label for="rs_poll_interval" class="label-with-tip">
                Poll interval (sec)
                <span class="tooltip-icon" title="Seconds between price polls and ranking updates.">?</span>
              </label>
              <input id="rs_poll_interval" name="poll_interval_sec" type="number" min="5" step="1" />
            </div>
            <div>
              <label for="rs_lookback" class="label-with-tip">
                Lookback window
                <span class="tooltip-icon" title="Number of samples used to compute the RS score per coin.">?</span>
              </label>
              <input id="rs_lookback" name="lookback_window" type="number" min="5" step="1" />
            </div>
            <div>
              <label for="rs_rebalance" class="label-with-tip">
                Rebalance interval (sec)
                <span class="tooltip-icon" title="Seconds between selecting new long/short spreads from the rankings.">?</span>
              </label>
              <input id="rs_rebalance" name="rebalance_interval_sec" type="number" min="30" step="1" />
            </div>
          </div>

          <div class="form-row">
            <div>
              <label for="rs_top_n" class="label-with-tip">
                Top-N longs
                <span class="tooltip-icon" title="How many strongest symbols to long in the basket.">?</span>
              </label>
              <input id="rs_top_n" name="top_n" type="number" min="1" step="1" />
            </div>
            <div>
              <label for="rs_bottom_n" class="label-with-tip">
                Bottom-N shorts
                <span class="tooltip-icon" title="How many weakest symbols to short in the basket.">?</span>
              </label>
              <input id="rs_bottom_n" name="bottom_n" type="number" min="1" step="1" />
            </div>
            <div>
              <label for="rs_min_gap" class="label-with-tip">
                Min RS gap
                <span class="tooltip-icon" title="Minimum RS spread between long and short legs before a spread is opened.">?</span>
              </label>
              <input id="rs_min_gap" name="min_rs_gap" type="number" step="0.1" />
            </div>
            <div>
              <label for="rs_notional" class="label-with-tip">
                Max notional per leg (<span class="quote-label">USDT</span>)
                <span class="tooltip-icon" title="Target quote size for each leg when not using the full balance.">?</span>
              </label>
              <input id="rs_notional" name="max_notional_usd" type="number" step="1" />
            </div>
          </div>

          <div class="form-row">
            <div class="form-checkbox">
              <input type="checkbox" id="rs_use_all" name="use_all_balance" />
              <label for="rs_use_all" class="label-with-tip">
                Use all quote balance
                <span class="tooltip-icon" title="Allocate the full quote balance across spreads instead of the notional cap.">?</span>
              </label>
            </div>
            <div class="form-checkbox">
              <input type="checkbox" id="rs_use_testnet" name="use_testnet" />
              <label for="rs_use_testnet" class="label-with-tip">
                Use Binance testnet
                <span class="tooltip-icon" title="Route RS trades to Binance testnet instead of live trading.">?</span>
              </label>
            </div>
          </div>

          <div class="button-row">
            <button type="submit" class="btn btn-primary">Save config</button>
            <button type="button" class="btn" data-close-overlay="rsConfigOverlay">Close</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <div id="nextModalOverlay" class="modal-overlay">
    <div class="modal">
      <div class="modal-header">
        <div class="modal-header-title">Next possible MR trade</div>
        <button class="btn btn-ghost small" id="nextModalClose">✕</button>
      </div>
      <div class="modal-body">
        <div id="nextSignalModalBody" class="status-section">Loading...</div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-primary small" id="nextModalRecalc">Recalculate</button>
        <button class="btn btn-ghost small" id="nextModalCloseFooter">Close</button>
      </div>
    </div>
  </div>
</body>
</html>
